{
    "model": {
        "name": "mlx-community/gemma-3-4b-it-bf16"
    },
    "training": {
        "iterations": 300,
        "learning_rate": 1e-6,
        "batch_size": 16,
        "log_steps": 10,
        "checkpoint_steps": 50,
        "resume_from_checkpoint": "",
        "save_adapter_to": "./adapters/grpo_lora_wordle",
        "config_file": "./config/grpo_lora_config.json"
    },
    "lora": {
        "rank": 16,
        "alpha": 32.0,
        "dropout": 0.1,
        "layers_to_tune": 33
    },
    "evaluation": {
        "steps": 20,
        "samples": 5
    },
    "rl": {
        "num_generations": 2,
        "max_completion_length": 512,
        "sampling_temperature": 0.9,
        "max_trials": 6
    },
    "grpo": {
        "clip_epsilon": 0.2,
        "ref_update_steps": 50,
        "kl_coeff": 0.1,
        "beta": 0.1
    },
    "reward": {
        "solution_correct_guess": 150.0,

        "valid_guess_base": 25.0,

        "information_gain_bonus_coeff": 2.5,
        "new_letter_bonus": 1.5,

        "length_penalty_per_token": 0.01,
        "time_penalty_per_guess": 1.0,
        
        "gray_letter_penalty": 15.0, 
        "yellow_letter_penalty": 15.0,
        "green_position_penalty": 20.0,
        "green_reuse_penalty": 0.5,
        "yellow_reuse_penalty": 0.2,
        
        "repetition_penalty": 30.0,
        "not_in_dictionary_penalty": 25.0,
        "format_fail_penalty": 120.0
   }
}