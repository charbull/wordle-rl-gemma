{
    "model": {
        "name": "mlx-community/gemma-3-4b-it-bf16"
    },
    "training": {
        "iterations": 300,
        "learning_rate": 5e-6,
        "batch_size": 16,
        "log_steps": 10,
        "checkpoint_steps": 50,
        "resume_from_checkpoint": "",
        "save_adapter_to": "./adapters/grpo_lora_wordle",
        "config_file": "./config/grpo_lora_config.json"
    },
    "lora": {
        "rank": 16,
        "alpha": 32.0,
        "dropout": 0.1,
        "layers_to_tune": 33
    },
    "evaluation": {
        "steps": 20,
        "samples": 5
    },
    "rl": {
        "num_generations": 2,
        "max_completion_length": 512,
        "sampling_temperature": 0.7,
        "max_trials": 6
    },
    "grpo": {
        "clip_epsilon": 0.2,
        "ref_update_steps": 50,
        "kl_coeff": 0.02,
        "beta": 0.1
    },
    "reward": {
        "solution_correct_guess": 150.0,

        "valid_guess_base": 5.0,
        "entropy_unique_letter_bonus": 5.0,
        "entropy_common_letter_bonus": 5.0,
        
        "length_penalty_per_token": -0.01,
        "time_penalty_per_guess": -1.0,
        "gray_letter_penalty": -5.0, 
        "yellow_letter_penalty": -10.0,
        "green_position_penalty": -15.0,
        
        "violated_clue_penalty": -50.0,
        "repetition_penalty": -75.0,
        "not_in_dictionary_penalty": -100.0,
        "format_fail_penalty": -125.0
   }
}